"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
var path_1 = require("path");
var _1 = require(".");
function provideGetFortaConfig(commandName, filesystem, isProduction, configFilename, localConfigFilename, fortaKeystore, getJsonFile) {
    _1.assertIsNonEmptyString(commandName, 'commandName');
    _1.assertExists(filesystem, 'filesystem');
    _1.assertIsNonEmptyString(configFilename, 'configFilename');
    _1.assertIsNonEmptyString(localConfigFilename, 'localConfigFilename');
    _1.assertIsNonEmptyString(fortaKeystore, 'fortaKeystore');
    _1.assertExists(getJsonFile, 'getJsonFile');
    return function getFortaConfig() {
        var config = {};
        if (commandName === "init" || isProduction)
            return config;
        var globalConfigPath = path_1.join(fortaKeystore, configFilename);
        if (filesystem.existsSync(globalConfigPath)) {
            try {
                config = Object.assign(config, getJsonFile(globalConfigPath));
            }
            catch (e) {
                throw new Error("unable to parse config file " + configFilename + ": " + e.message);
            }
        }
        var localConfigPath = path_1.join(process.cwd(), localConfigFilename);
        if (filesystem.existsSync(localConfigPath)) {
            try {
                config = Object.assign(config, getJsonFile(localConfigPath));
            }
            catch (e) {
                throw new Error("unable to parse project config file " + localConfigFilename + ": " + e.message);
            }
        }
        return config;
    };
}
exports.default = provideGetFortaConfig;
